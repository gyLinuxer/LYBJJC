{__NOLAYOUT__}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link id="bs-css" href="__PUBLIC__/css/bootstrap-cerulean.min.css" rel="stylesheet">
    <link href="__PUBLIC__/css/charisma-app.css" rel="stylesheet">
    <link href='__PUBLIC__/bower_components/fullcalendar/dist/fullcalendar.css' rel='stylesheet'>
    <link href='__PUBLIC__/bower_components/fullcalendar/dist/fullcalendar.print.css' rel='stylesheet' media='print'>
    <link href='__PUBLIC__/bower_components/chosen/chosen.min.css' rel='stylesheet'>
    <link href='__PUBLIC__/bower_components/colorbox/example3/colorbox.css' rel='stylesheet'>
    <link href='__PUBLIC__/bower_components/responsive-tables/responsive-tables.css' rel='stylesheet'>
    <link href='__PUBLIC__/bower_components/bootstrap-tour/build/css/bootstrap-tour.min.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/jquery.noty.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/noty_theme_default.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/elfinder.min.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/elfinder.theme.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/jquery.iphone.toggle.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/uploadify.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/animate.min.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/doc.min.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/MyCss.css' rel='stylesheet'>
    <link href='__PUBLIC__/css/jquery-ui.min.css' rel='stylesheet'>

    <link href="__PUBLIC__/css/bootstrap-table.css" rel="stylesheet">
    <link href="__PUBLIC__/css/zTreeStyle/zTreeStyle.css" rel="stylesheet">
    <link href="__PUBLIC__/css/bootstrap-editable.css" rel="stylesheet">
    <link href="__PUBLIC__/css/ui-dialog.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="__PUBLIC__/js/jquery.js"></script>
    <script src="__PUBLIC__/js//bootstrap.js"></script>

    <!-- include summernote css/js -->
    <link href="__PUBLIC__/css/summernote.css" rel="stylesheet">
    <script src="__PUBLIC__/js/summernote.js"></script>

    <!-- library for cookie management -->
    <script src="__PUBLIC__/js/jquery.cookie.js"></script>
    <!-- calender plugin -->

    <!-- data table plugin -->
    <script src='__PUBLIC__/js/jquery.dataTables.min.js'></script>

    <!-- select or dropdown enhancer -->
    <script src="__PUBLIC__/bower_components/chosen/chosen.jquery.min.js"></script>
    <!-- plugin for gallery image view -->
    <script src="__PUBLIC__/bower_components/colorbox/jquery.colorbox-min.js"></script>
    <!-- notification plugin -->
    <script src="__PUBLIC__/js/jquery.noty.js"></script>
    <!-- library for making tables responsive -->
    <script src="__PUBLIC__/bower_components/responsive-tables/responsive-tables.js"></script>
    <!-- tour plugin -->
    <script src="__PUBLIC__/bower_components/bootstrap-tour/build/js/bootstrap-tour.min.js"></script>
    <!-- star rating plugin -->
    <!-- for iOS style toggle switch -->
    <!-- autogrowing textarea plugin -->
    <script src="__PUBLIC__/js/jquery.autogrow-textarea.js"></script>
    <!-- multiple file upload plugin -->
    <script src="__PUBLIC__/js/jquery.uploadify-3.1.min.js"></script>
    <script src="__PUBLIC__/js/gyComm.js"></script>
    <script src="__PUBLIC__/js/jquery-ui.min.js"></script>
    <script src="__PUBLIC__/js/gyComm.js"></script>
    <script src="__PUBLIC__/js//bootstrap-slider.min.js"></script>
    <link href="__PUBLIC__/css/select2.min.css" rel="stylesheet" />
    <script src="__PUBLIC__/js/select2.min.js"></script>
    <link href="__PUBLIC__/css/bootstrap-datetimepicker.css" rel="stylesheet">
    <script src="__PUBLIC__/js/dialog-plus-min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/js/jquery.treegrid.js"></script>
    <link rel="stylesheet" href="__PUBLIC__/css/jquery.treegrid.css">
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/UEditor/ueditor.config.js"> </script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/UEditor/ueditor.all.js"> </script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/UEditor/lang/zh-cn/zh-cn.js"></script>
    <script src="__PUBLIC__/js/GY.js"></script>
    <link href="__PUBLIC__/css/dialog.css" rel="stylesheet">
    <script src="__PUBLIC__/js/dialog-plus.js"></script>
    <script src="__PUBLIC__/layer/layer.js"></script>
    <script src="__PUBLIC__/js/GY.js"></script>
    <STYLE>
        .select2-container .select2-selection--single{
            height:34px;
            line-height: 34px;
        }
        .xuxian{
            height:0;
            border-bottom:#000000 2px dashed;
        }
    </STYLE>
</head>
<body class="container-full">
<form action="/SafetyMng/CheckTask/CheckRowQuery/CheckListID/{$CheckListID}" method="post" enctype="application/x-www-form-urlencoded">
    <input type="hidden" id="opType" name="opType" value=""/>
    <input type="hidden" id="CurRowId" name="CurRowId" value="0"/>
    {php}
        $CTBMng = new app\safetymng\controller\CheckTBMng();
    {/php}
    <div style="width: 96%;margin-left: 2%;" >
        <div class="row">
            <table class="table table-bordered col-sm-11">
                <tr>
                    <td style="width: 10%;"><span style="font-weight: bold;">数据库:</span></td>
                    <td style="width: 20%">
                        <select class="form-control required"  name="CheckDB" id="CheckDB" LinkAge>
                            <option></option>
                            {volist name="CheckDB" id="vo"}
                                <option value="{$vo.id}" {eq name="Think.post.CheckDB1" value="{$vo.id}"} selected {/eq}>{$vo.BaseName}</option>
                            {/volist}
                        </select>
                    </td>
                    <td style="width: 13%">
                        <span style="font-weight: bold;">专业名称:</span>
                    </td>
                    <td style="width: 20%">
                        <select class="form-control required"  data-tags="true" name="ProfessionName" id="ProfessionName" LinkAge>
                            <option></option>
                            <option value="{php}echo $CTBMng->RMInputPre(input('ProfessionName'));{/php}" selected>{php}echo $CTBMng->RMInputPre(input('ProfessionName'));{/php}</option>
                        </select>
                    </td>
                    <td style="width: 10%">
                        <span style="font-weight: bold;">业务名称:</span>
                    </td>
                    <td style="width: 10%">
                        <select class="form-control required" data-tags="true"  name="BusinessName" id="BusinessName" LinkAge>
                            <option></option>
                            <option value="{php}echo $CTBMng->RMInputPre(input('BusinessName'));{/php}" selected>{php}echo $CTBMng->RMInputPre(input('BusinessName'));{/php}</option>
                        </select>
                    </td>
                    <td style="width: 3%"><span style="font-weight: bold;">部门:</span></td>
                    <td >
                        <select class="form-control required"  name="RelatedCorps[]" multiple="multiple"  id="RelatedCorps" >
                            <option></option>
                             {volist name="CorpList" id="vo"}
                                <option value="{$vo.Corp}">{$vo.Corp}</option>
                            {/volist}
                        </select>
                    </td>

                </tr>
                <tr>
                    <div class="row">

                        <td><span style="font-weight: bold;">检查项目:</span></td>
                        <td colspan="">
                            <select class="form-control required" data-tags="true" name="CheckSubject" id="CheckSubject" LinkAge>
                                <option></option>
                                <option value="{php}echo $CTBMng->RMInputPre(input('CheckSubject'));{/php}" selected>{php}echo $CTBMng->RMInputPre(input('CheckSubject'));{/php}</option>
                            </select>
                        </td>
                        <td><span style="font-weight: bold;">编号1:</span></td>
                        <td >
                            <select class="form-control required"  data-tags="true" name="Code1"  id="Code1" LinkAge>
                                <option></option>
                                <option value="{php}echo $CTBMng->RMInputPre(input('Code1'));{/php}" selected>{php}echo $CTBMng->RMInputPre(input('Code1'));{/php}</option>
                            </select>
                        </td>
                        <td><span style="font-weight: bold;">编号2:</span></td>
                        <td >
                            <select class="form-control required"  data-tags="true" name="Code2"  id="Code2" LinkAge>
                                <option></option>
                                <option value="{php}echo $CTBMng->RMInputPre(input('Code1'));{/php}" selected>{php}echo $CTBMng->RMInputPre(input('Code1'));{/php}</option>
                            </select>
                        </td>
                        <td colspan="2"style="text-align: center;">
                            <button type="submit"  class="btn btn-success">查询</button>
                        </td>

                    </div >
                </tr>
                <tr>
                    <td ><span style="font-weight: bold;">检查内容:</span></td>
                    <td >
                        <select class="form-control required" data-tags="true" name="CheckContent" id="CheckContent" LinkAge>
                            <option value="{php}echo $CTBMng->RMInputPre(input('CheckContent'));{/php}" selected>{php}echo $CTBMng->RMInputPre(input('CheckContent'));{/php}</option>
                        </select>
                    </td>
                    <td >
                        <span style="font-weight: bold;">检查标准:</span>
                    </td>
                    <td colspan="5">
                        <select class="form-control required" data-tags="true" name="CheckStandard"  id="CheckStandard" >
                            <option></option>
                            <option>{php}echo $CTBMng->getCheckStandard(input('CheckStandard'));{/php}</option>
                        </select>
                    </td>
                </tr>
                <tr>


                </tr>
            </table>
        </div>
        <div class="row " style="margin-top: 15px;">
            <div class="col-sm-12 xuxian"></div>
        </div>
        <div class="row" style="margin-top: 15px;">
            <div class="col-sm-12" >
                <div id = "gyDiv" style="overflow:scroll; width:100%;min-height: 400px;">
                    <table class="table  table-bordered bootstrap-datatable datatable table-hover responsive" style="min-width:200%;">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th class="col-sm-3">检查标准</th>
                            <th class="col-sm-4">符合性验证标准<span>&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox"/>全选</span>&nbsp;&nbsp;&nbsp;&nbsp;<span><input type="checkbox"/>全不选</span> <a class="btn btn-sm btn-warning">+</a></th><!-- 生成类型 航空公司　起点　终点　航班类型--->
                            <th>检查方法</th>
                            <th>依据名称</th>
                            <th>依据条款</th><!-- 航空公司　机号　机型　座位总数-->
                            <th>责任单位</th>
                            <th>检查频次</th>
                        </thead>
                        <tbody >
                        {volist name="CheckRowList" id="vo"}
                        <tr CheckStandardID = "{$vo.CheckStandardID}" rowId = "{$vo.id}" >
                            <td>
                               <input type="checkbox" SelCkBox FHID = "{$vo.FHId}" SHID = "{$vo.id}" BaseDBID="{$vo.BaseDBID}" CKListRowId = "{$vo.CheckListRowId}" />
                            </td>
                            <td>
                                {$vo.CheckStandard}
                            </td>
                            <td>
                                {$vo.ComplianceStandard}
                            </td>
                            <td>
                                {$vo.CheckMethods}
                            </td>
                            <td>
                                {$vo.BasisName}
                            </td>
                            <td>
                                {$vo.BasisTerm}
                            </td>
                            <td>
                                {$vo.RelatedCorps}
                            </td>
                            <td>
                                {$vo.CheckFrequency}
                            </td>
                        </tr>
                        {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" name="RowSeled" value=""/>
    <input type="hidden" name="CheckTaskID" value="{$CheckListID}"/>
</form>
</body>
<script>
    $RowSel_Arr = [1,2,3];
    $CheckListID = {$CheckListID};

    function FillAllSelectById ($id) {
        $.ajax({
            url:"/SafetyMng/Help/GetFirstHalfCheckTBRowById/id/"+$id,
            type:'get',
            dataType:"json",
            success:function (data,textStatus) {
                if(data==null){
                    layer.alert('获取数据失败!');
                    return;
                }
                $('#ProfessionName').select2({data:[{'text':data.ProfessionName,'id':data.ProfessionName}]});
                $('#ProfessionName').val(data.ProfessionName).trigger('change');

                $('#BusinessName').select2({data:[{'text':data.BusinessName,'id':data.BusinessName}]});
                $('#BusinessName').val(data.BusinessName).trigger('change');

                $('#CheckSubject').select2({data:[{'text':data.CheckSubject,'id':data.CheckSubject}]});
                $('#CheckSubject').val(data.CheckSubject).trigger('change');

                $('#Code1').select2({data:[{'text':data.Code1,'id':data.Code1}]});
                $('#Code1').val(data.Code1).trigger('change');

                $('#Code2').select2({data:[{'text':data.Code2,'id':data.Code2}]});
                $('#Code2').val(data.Code2).trigger('change');

                $('#CheckContent').select2({data:[{'text':data.CheckContent,'id':data.CheckContent}]});
                $('#CheckContent').val(data.CheckContent).trigger('change');

                $('#CheckStandard').select2({data:[{'text':data.CheckStandard,'id':data.CheckStandard}]});
                $('#CheckStandard').val(data.CheckStandard).trigger('change');

                $('#CheckDB').val(data.CheckDBId).trigger('change');

                $('#CheckStandardEdit').text(data.CheckStandard);

            },
            error:function (XMLHttpRequest,textStatus,errorThrown) {

            }
        });
    }

    function SelectLinkage (SelID) {
        $Pv = [];
        $SelArr = ['CheckDB','ProfessionName','BusinessName','CheckSubject','Code1','Code2','CheckContent','CheckStandard'];
        $SelArr.forEach(function (v) {
            $r = {'SelName':v,'SelText':$('#'+v + ' option:selected').text(),'SelVal':$('#'+v).val()};
            $Pv.push($r);
        });
        $PostData = {"EventSel":SelID,'data':$Pv,'FakeID':'YES','FakeCheckStandardID':''};
        $.ajax({
            url:"/SafetyMng/Help/Ajax_SelectLinkage",
            data: JSON.stringify($PostData),
            type:'post',
            dataType:"json",
            success:function (data,textStatus) {
                $TargetSel = data['TargetSel'];
                $SelData = data['data'];
                //alert($TargetSel);
                $bBegin = false;
                $SelArr.forEach(function (v) {
                    if($bBegin){
                        $('#'+v).html('').select2('data', null);
                    }
                    if(v==SelID){
                        $bBegin =true;
                    }
                });
                $('#'+$TargetSel).select2({data:$SelData});
                $('#'+$TargetSel).val('').select2();
            },
            error:function (XMLHttpRequest,textStatus,errorThrown) {

            }
        });
    }
    $RelatedCorps = {$RelatedCorps|default=[]};
    $(function () {
        $('select').select2();

        $('select[LinkAge]').on("change", function(e) {
            $val  = $(this).val();
            $text = $('#'+$(this).attr('id') + ' option:selected').text();
            if($val!='' && ($text ==$val)){

            }else{
                SelectLinkage($(this).attr('id'))
            }

            $('#RelatedCorps').val($RelatedCorps).change();

            $('input[checkbox]').click(function () {
                alert($(this).attr('FHID'));
            });
        });
    });
</script>
</html>